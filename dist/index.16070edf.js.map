{"mappings":"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","sources":["src/assets/js/login.js"],"sourcesContent":["let users = [];\r\nlet currentUser = null;\r\n\r\nconst loginPage = document.querySelector('#login');\r\nconst currentUserDisplay = document.querySelector('#currentUserDisplay');\r\nconst currentUserDisplay_dropitem1 = document.querySelector('#currentUserDisplay_dropitem1');\r\nconst loginPaymentProcess = document.querySelector('#payment-process');\r\n\r\ndocument.addEventListener('DOMContentLoaded', () => {\r\n    users = JSON.parse(localStorage.getItem('users')) || [];\r\n    currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    saveUsersToStorage();\r\n    saveCurrentUserToStorage();\r\n}) // Lee el elemento users y currentUser luego de que el dom es cargado\r\n\r\nif (loginPage)\r\n{\r\n    button.addEventListener('click', (e) =>{\r\n        e.preventDefault();\r\n    })\r\n}\r\nif (currentUserDisplay)\r\n{\r\n    currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n    \r\n    if (currentUser == null){\r\n        currentUserDisplay.innerHTML = '<i class=\"fa-solid fa-user\"></i><br>Invitado';\r\n        currentUserDisplay_dropitem1.innerHTML = 'Iniciar sesión';\r\n    }\r\n    else{\r\n        currentUserDisplay.innerHTML = '<i class=\"fa-solid fa-user\"></i><br>' + currentUser.username;\r\n        currentUserDisplay_dropitem1.innerHTML = 'Cerrar sesión';\r\n    }\r\n}\r\nif (loginPaymentProcess && currentUser != null){\r\n    const _cliente = document.getElementById('cliente');\r\n    const _correo = document.getElementById('correo');\r\n\r\n    _cliente.value = currentUser.fullname;\r\n    _correo.value = currentUser.email;\r\n\r\n    _cliente.setAttribute(\"disabled\", \"\");\r\n    _correo.setAttribute(\"disabled\", \"\");\r\n}\r\n\r\n// Functions\r\n\r\nfunction registerUser(){\r\n    const email = document.getElementById('regis-email');\r\n    const fullname = document.getElementById('regis-fullname');\r\n    const username = document.getElementById('regis-username');\r\n    const password = document.getElementById('regis-password');\r\n    const c_password = document.getElementById('regis-c_password');\r\n    \r\n    console.log(password.value + \" === \" + c_password.value);\r\n\r\n    if (password.value !== c_password.value){\r\n        alert(\"Las contraseñas ingresadas no coinciden\");\r\n        return;\r\n    }\r\n    if (checkPassword(password.value) == false){\r\n        alert(\"La contraseña no cumple los requisitos. La contraseña debe contener al menos 8 caracteres, mayúsculas, minúsculas y números.\");\r\n        return;\r\n    }\r\n\r\n    const newUserData = {\r\n        email: email.value,\r\n        fullname: fullname.value,\r\n        username: username.value,\r\n        password: password.value\r\n    }\r\n\r\n    const userNameExist = users.some(user => user.username === newUserData.username);\r\n    const emailExist = users.some(user => user.email === newUserData.email);\r\n\r\n    if (userNameExist){\r\n        alert(\"Nombre de usuario ya registrado, ingrese otro nombre de usuario.\");\r\n        return;\r\n    }\r\n    else if(emailExist){\r\n        alert(\"Correo ya registrado, ingrese otro correo.\");\r\n        return;\r\n    }\r\n    else{\r\n        users.push(newUserData);\r\n        console.log(users);\r\n    }\r\n    saveUsersToStorage();\r\n    alert(\"Usuario registrado con éxito.\")\r\n    window.location = \"login.html\";\r\n}\r\n\r\nfunction logIn(){\r\n    const username = document.getElementById('login-username');\r\n    const password = document.getElementById('login-password');\r\n\r\n    console.log(username.value + \" \" + password.value);\r\n    \r\n    // busca al usuario en localStorage\r\n    const user = users.find(user => user.username === username.value);\r\n\r\n    console.log(user);\r\n\r\n    if(user === undefined){\r\n        alert(\"El usuario no existe.\");\r\n    }\r\n    else{\r\n        if (password.value === user.password){\r\n            currentUser = user;\r\n            saveCurrentUserToStorage();\r\n            alert(\"Bienvenido \" + currentUser.username);\r\n            window.location = \"index.html\";\r\n        }\r\n        else{\r\n            alert(\"La contraseña no es correcta. Vuelva a intentarlo.\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction newPassword(){\r\n    const email = document.getElementById('recover-email');\r\n    const newPassword = document.getElementById('recover-newPassword');\r\n    const cPassword = document.getElementById('recover-cPassword');\r\n\r\n    // busca al usuario en localStorage\r\n    const user = users.find(user => user.email === email.value);\r\n\r\n    console.log(user);\r\n\r\n    if(user === undefined){\r\n        alert(\"No existe un usuario registrado con el correo ingresado.\");\r\n    }\r\n    else{\r\n        if (newPassword.value === cPassword.value){\r\n            if (checkPassword(password.value) == false){\r\n                alert(\"La contraseña no cumple los requisitos. La contraseña debe contener al menos 8 caracteres, mayúsculas, minúsculas y números.\");\r\n                return;\r\n            }\r\n            console.log(\"passwords coincidentes\");\r\n            for (const u of users){\r\n                console.log(u);\r\n                if (u.username === user.username){\r\n                    u.password = newPassword.value;\r\n                    saveUsersToStorage();\r\n                    alert(\"Hola \" + user.username + \". Tu contraseña se ha reestablecido con éxito.\");\r\n                    window.location = \"login.html\";\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            alert(\"Las contraseñas no coinciden. Vuelva a intentarlo.\");\r\n        }\r\n    }\r\n}\r\n\r\nfunction logOut(){\r\n    currentUser = null;\r\n    saveCurrentUserToStorage();\r\n}\r\n\r\nfunction checkPassword(password){\r\n    // Requerimientos password: 1 MAYUSCULA, 1 minuscula, 1 numero, minimo 8 caracteres\r\n    const pattern = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,}$/gm;\r\n    return pattern.test(password);\r\n}\r\n\r\nfunction saveUsersToStorage()\r\n{\r\n    localStorage.setItem(\"users\", JSON.stringify(users));\r\n}\r\n\r\nfunction saveCurrentUserToStorage()\r\n{\r\n    localStorage.setItem(\"currentUser\", JSON.stringify(currentUser));\r\n}"],"names":[],"version":3,"file":"index.16070edf.js.map","sourceRoot":"/__parcel_source_root/"}